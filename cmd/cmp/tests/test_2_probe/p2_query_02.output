{"queryId":"20240611_143113_00288_db7fk","session":{"queryId":"20240611_143113_00288_db7fk","transactionId":"7ef45931-b47a-40eb-9426-fd00e620176c","clientTransactionSupport":false,"user":"presto","principal":"presto","source":"ds_power_query_36_c0","catalog":"hive","schema":"tpcds_sf1000_parquet_delta","traceToken":"noop_dummy_id","timeZoneKey":0,"locale":"en_US","remoteUserAddress":"52.205.16.24","userAgent":"Go-http-client/2.0","clientTags":["ds_power"],"resourceEstimates":{},"startTime":1718116273269,"systemProperties":{"join_distribution_type":"AUTOMATIC","join_reordering_strategy":"AUTOMATIC","query_max_execution_time":"8h"},"catalogProperties":{"hive":{"parquet_pushdown_filter_enabled":"true","pushdown_filter_enabled":"false"}},"unprocessedCatalogProperties":{},"roles":{},"preparedStatements":{},"sessionFunctions":{}},"state":"FINISHED","memoryPool":"general","scheduled":true,"self":"http://10.0.1.3:8080/v1/query/20240611_143113_00288_db7fk","fieldNames":["gross_margin","i_category","i_class","lochierarchy","rank_within_parent"],"query":"--TPC-DS Q36\nselect sum(ss_net_profit) / sum(ss_ext_sales_price)            as gross_margin\n     , i_category\n     , i_class\n     , grouping(i_category) + grouping(i_class)                as lochierarchy\n     , rank() over (\n    partition by grouping(i_category) + grouping(i_class),\n        case when grouping(i_class) = 0 then i_category end\n    order by sum(ss_net_profit) / sum(ss_ext_sales_price) asc) as rank_within_parent\nfrom store_sales\n   , date_dim d1\n   , item\n   , store\nwhere d1.d_year = 2001\n  and d1.d_date_sk = ss_sold_date_sk\n  and i_item_sk = ss_item_sk\n  and s_store_sk = ss_store_sk\n  and s_state in (\u0027TN\u0027, \u0027TN\u0027, \u0027TN\u0027, \u0027TN\u0027,\n                  \u0027TN\u0027, \u0027TN\u0027, \u0027TN\u0027, \u0027TN\u0027)\ngroup by rollup (i_category, i_class)\norder by lochierarchy desc\n       , case when lochierarchy = 0 then i_category end\n       , rank_within_parent\nlimit 100","queryStats":{"createTime":"2024-06-11T14:31:13.271Z","executionStartTime":"2024-06-11T14:31:13.276Z","lastHeartbeat":"2024-06-11T14:32:28.903Z","endTime":"2024-06-11T14:32:28.904Z","elapsedTime":"1.26m","waitingForPrerequisitesTime":"551.29us","queuedTime":"47.60us","resourceWaitingTime":"26.23us","semanticAnalyzingTime":"4.54ms","columnAccessPermissionCheckingTime":"35.91us","dispatchingTime":"4.45ms","executionTime":"1.26m","analysisTime":"74.95ms","totalPlanningTime":"76.86ms","finishingTime":"522.47us","totalTasks":32,"runningTasks":0,"peakRunningTasks":32,"completedTasks":32,"totalDrivers":7510,"queuedDrivers":0,"runningDrivers":0,"blockedDrivers":0,"completedDrivers":7510,"cumulativeUserMemory":1.413603090195836E13,"cumulativeTotalMemory":3.51514177693267E13,"userMemoryReservation":"0B","totalMemoryReservation":"0B","peakUserMemoryReservation":"220.92MB","peakTotalMemoryReservation":"2.08GB","peakTaskUserMemory":"22.94MB","peakTaskTotalMemory":"345.46MB","peakNodeTotalMemory":"361.96MB","scheduled":true,"totalScheduledTime":"1.05h","totalCpuTime":"26.46m","retriedCpuTime":"0.00ns","totalBlockedTime":"17.48h","fullyBlocked":true,"blockedReasons":[],"totalAllocation":"0B","rawInputDataSize":"45.92GB","rawInputPositions":2880362050,"processedInputDataSize":"46.02GB","processedInputPositions":2882983044,"shuffledDataSize":"99.15MB","shuffledPositions":2620994,"outputDataSize":"5.24kB","outputPositions":100,"writtenOutputPositions":0,"writtenOutputLogicalDataSize":"0B","writtenOutputPhysicalDataSize":"0B","writtenIntermediatePhysicalDataSize":"0B","stageGcStatistics":[{"stageId":0,"stageExecutionId":0,"tasks":1,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":1,"stageExecutionId":0,"tasks":8,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":2,"stageExecutionId":0,"tasks":8,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":3,"stageExecutionId":0,"tasks":8,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":4,"stageExecutionId":0,"tasks":1,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":5,"stageExecutionId":0,"tasks":3,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0},{"stageId":6,"stageExecutionId":0,"tasks":3,"fullGcTasks":0,"minFullGcSec":0,"maxFullGcSec":0,"totalFullGcSec":0,"averageFullGcSec":0}],"operatorSummaries":[{"stageId":0,"stageExecutionId":0,"pipelineId":0,"operatorId":0,"planNodeId":"1365","operatorType":"ExchangeOperator","totalDrivers":16,"addInputCalls":0,"addInputWall":"0.00ns","addInputCpu":"0.00ns","addInputAllocation":"0B","rawInputDataSize":"12.13kB","rawInputPositions":196,"inputDataSize":"11.54kB","inputPositions":196,"sumSquaredInputPositions":15734.0,"getOutputCalls":12,"getOutputWall":"1.22ms","getOutputCpu":"230.87us","getOutputAllocation":"0B","outputDataSize":"11.54kB","outputPositions":196,"physicalWrittenDataSize":"0B","additionalCpu":"0.00ns","blockedWall":"20.14m","finishCalls":0,"finishWall":"0.00ns","finishCpu":"0.00ns","finishAllocation":"0B","userMemoryReservation":"0B","revocableMemoryReservation":"0B","systemMemoryReservation":"0B","peakUserMemoryReservation":"0B","peakSystemMemoryReservation":"0B","peakTotalMemoryReservation":"0B","spilledDataSize":"0B","info":{"@type":"exchangeClientStatus","bufferedBytes":0,"maxBufferedBytes":3836,"averageBytesPerRequest":687,"successfulRequestsCount":6672,"bufferedPages":0,"noMoreLocations":true,"pageBufferClientStatuses":[]},"runtimeStats":{},"dynamicFilterStats":{"producerNodeIds":[]},"nullJoinBuildKeyCount":0,"joinBuildKeyCount":0,"nullJoinProbeKeyCount":0,"joinProbeKeyCount":0},{"stageId":0,"stageExecutionId":0,"pipelineId":1,"operatorId":0,"planNodeId":"1515","operatorType":"LocalExchangeSourceOperator","totalDrivers":1,"addInputCalls":0,"addInputWall":"0.00ns","addInputCpu":"0.00ns","addInputAllocation":"0B","rawInputDataSize":"0B","rawInputPositions":0,"inputDataSize":"11.54kB","inputPositions":196,"sumSquaredInputPositions":38416.0,"getOutputCalls":12,"getOutputWall":"74.92us","getOutputCpu":"69.60us","getOutputAllocation":"0B","outputDataSize":"11.54kB","outputPositions":196,"physicalWrittenDataSize":"0B","additionalCpu":"0.00ns","blockedWall":"1.26m","finishCalls":0,"finishWall":"0.00ns","finishCpu":"0.00ns","finishAllocation":"0B","userMemoryReservation":"0B","revocableMemoryReservation":"0B","systemMemoryReservation":"0B","peakUserMemoryReservation":"0B","peakSystemMemoryReservation":"0B","peakTotalMemoryReservation":"0B","spilledDataSize":"0B","runtimeStats":{},"dynamicFilterStats":{"producerNodeIds":[]},"nullJoinBuildKeyCount":0,"joinBuildKeyCount":0,"nullJoinProbeKeyCount":0,"joinProbeKeyCount":0},{"stageId":0,"stageExecutionId":0,"pipelineId":0,"operatorId":1,"planNodeId":"1515","operatorType":"LocalExchangeSinkOperator","totalDrivers":16,"addInputCalls":12,"addInputWall":"151.29us","addInputCpu":"152.81us","addInputAllocation":"0B","rawInputDataSize":"0B","rawInputPositions":0,"inputDataSize":"11.54kB","inputPositions":196,"sumSquaredInputPositions":15734.0,"getOutputCalls":0,"getOutputWall":"0.00ns","getOutputCpu":"0.00ns","getOutputAllocation":"0B","outputDataSize":"11.54kB","outputPositions":196,"physicalWrittenDataSize":"0B","additionalCpu":"0.00ns","blockedWall":"0.00ns","finishCalls":16,"finishWall":"84.90us","finishCpu":"68.78us","finishAllocation":"0B","userMemoryReservation":"0B","revocableMemoryReservation":"0B","systemMemoryReservation":"0B","peakUserMemoryReservation":"0B","peakSystemMemoryReservation":"0B","peakTotalMemoryReservation":"0B","spilledDataSize":"0B","runtimeStats":{},"dynamicFilterStats":{"producerNodeIds":[]},"nullJoinBuildKeyCount":0,"joinBuildKeyCount":0,"nullJoinProbeKeyCount":0,"joinProbeKeyCount":0},{"stageId":0,"stageExecutionId":0,"pipelineId":1,"operatorId":1,"planNodeId":"1181","operatorType":"TopNOperator","totalDrivers":1,"addInputCalls":12,"addInputWall":"278.51us","addInputCpu":"278.81us","addInputAllocation":"0B","rawInputDataSize":"0B","rawInputPositions":0,"inputDataSize":"11.54kB","inputPositions":196,"sumSquaredInputPositions":38416.0,"getOutputCalls":25,"getOutputWall":"208.43us","getOutputCpu":"207.94us","getOutputAllocation":"0B","outputDataSize":"6.28kB","outputPositions":100,"physicalWrittenDataSize":"0B","additionalCpu":"0.00ns","blockedWall":"0.00ns","finishCalls":3,"finishWall":"18.02us","finishCpu":"17.06us","finishAllocation":"0B","userMemoryReservation":"0B","revocableMemoryReservation":"0B","systemMemoryReservation":"0B","peakUserMemoryReservation":"58.13kB","peakSystemMemoryReservation":"0B","peakTotalMemoryReservation":"58.13kB","spilledDataSize":"0B","runtimeStats":{},"dynamicFilterStats":{"producerNodeIds":[]},"nullJoinBuildKeyCount":0,"joinBuildKeyCount":0,"nullJoinProbeKeyCount":0,"joinProbeKeyCount":0},{"stageId":0,"stageExecutionId":0,"pipelineId":1,"operatorId":2,"planNodeId":"133","operatorType":"FilterAndProjectOperator","totalDrivers":1,"addInputCalls":1,"addInputWall":"5.89us",